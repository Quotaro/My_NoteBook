# PCネットワーク（WEB）、インフラ関連

## 目次 [Contents]

1. [概要](#ID_1)
1. [インフラの基礎事項](#ID_3)
    1. [システム基盤 [System Infrastructure]](#ID_3-1)
    1. [オンプレミスとクラウド](#ID_3-2)
		1. [オンプレミス [on-premise]](#ID_3-2-1)
		1. [パブリッククラウド [public cloud]](#ID_3-2-2)
		1. [プライベートクラウド [private cloud]](#ID_3-2-3)
		1. [クラウドとオンプレミスの選択](#ID_3-2-4)
	1. [ハードウェアとネットワークの基礎事項](#ID_3-3)
    	1. [ネットワーク機器](#ID_3-3-1)
		1. [OSI 基本参照モデル](#ID_3-3-2)
		1. [ネットワークアドレス](#ID_3-3-3)
		1. [リピーター、ハブ](#ID_3-3-4)
		1. [ブリッジ、レイヤー２スイッチ](#ID_3-3-5)
		1. [ルーター、レイヤー３スイッチ](#ID_3-3-6)
		1. [ファイアウォール](#ID_3-3-7)
	1. Linux OS の基礎事項
    	1. xxx
    1. [システム基盤の構築、運用の流れ（ウォータフォール開発、アジャイル開発）](#ID_3-x)
1. xxx

---

<a id="ID_1"></a>

## ■ 概要
![image](https://user-images.githubusercontent.com/25688193/41355764-39f414c0-6f5d-11e8-9991-efdc8657b344.png)<br>

開発したアプリケーションをリリースして、エンドユーザーに使いやすく利用してもらうためには、
ハードウェア、OS 等のインフラから構成される**システム基盤 [System Infrastructure]** を構成し、
その層の上にアプリケーションの実行環境を構成する必要がある。（上図）<br>
**Docker は、このアプリケーションの実行環境を作成、管理するためのプラットホーム [platform] （土台環境）である。**<br>

<br>

従来のウォータフォールモデルで開発されるシステム開発では、
アプリケーションの実行環境の構築は、ハードウェアやネットワークに精通したインフラエンジニアが行い、
アプリケーション本体の開発は、アプリケーションエンジニアが行う手法が一般的であった。

しかしながら、クラウド技術の登場により、この従来のシステム開発の手法が大きな変化があった。<br>
具体的には、従来のように自社でデータセンターやマシンルームを保有するような、**オンプレミス [on-premises]** 環境で駆動させていたサーバー群を、
クラウド上の**仮想インスタンス [VM : Virtual Machine instance]** に移行し、又、クラウドサービスにあるデータベースやネットワークを利用することで、
アプリケーションの実行環境の構築範囲が極めて小さくなり、短いサイクルで（アプリケーションの）リリースを繰り返すスタイルに変化した。<br>

クラウドを構成する技術の多くは、１台の**物理ホスト** （ネットワーク上のサーバーの一種）上で駆動するシステムとは異なり、
**分散環境 [distributed environment]** での駆動が基本となる。<br>
そして、このような分散環境では、従来のインフラエンジニアによる手動の操作ではなく、
自動化ツールを使用して**オーケストレーション**（複雑なコンピュータシステムの自動化）を行う。<br>
その為、インフラエンジニアには、インフラ技術に加えてアプリケーションエンジニアと同様に、コードを各スキルが求められるようになった。<br>
一方で、アプリケーションエンジニアも、これまでインフラエンジニアのタスクであった、
プロダクション環境（本番環境）への**デプロイ [deploy]**（主にWEBアプリケーションなどのシステム開発においてシステムを利用可能な状態にすること）やテストなども、アプリケーションエンジニア自らが行うことも可能になったため、OS（カーネル）やネットワークのインフラ技術の基礎知識が必要になった。<br>

---

<a id="ID_3"></a>

## ■ インフラの基礎事項

<a id="ID_3-1"></a>

### ◎ システム基盤 [System Infrastructure]
システム基盤とは、アプリケーションを駆動させるために必要なハードウェアや OS、ミドルウェアなどのインフラのことを指す。
このシステム基盤は、以下の基本要素から構成される。

![image](https://user-images.githubusercontent.com/25688193/41374963-98d188d8-6f8f-11e8-8b8f-64e6a2c2718c.png)<br>

- ハードウェア<br>
	システム基盤を構成する物理的な要素で、
	具体的には、サーバー機材本体やデータを保管するためのストレージ、電源装置を指す。
	広義には、これらハードウェア群を設置するデータセンターの設備（建屋、空調、セキュリティ設備、消化設備）を含む。

- ネットワーク<br>
	システムの利用者が遠距離からアクセスできるように、サーバー群を接続する装置。
	具体的には、ルーター、スイッチ、ファイアウォール等のネットワーク機器や、それらを接続するためのケーブル配線など。
	無線LAN で接続する場合は、アクセスポイントも必要となる。

- OS<br>
	クライアントOSとしては、Windows, masOS等がある。
	サーバーOSとしては、Linux, Unix, Windows Server 等がある。

- ミドルウェア<br>
    ここでいうミドルウェアは、”サーバーOS上で”サーバーが特定の役割を果たすための機能をもつソフトウェアを指す。

<br>

<a id="ID_3-2"></a>

### ◎ オンプレミスとクラウド

<a id="ID_3-2-1"></a>

#### ☆ オンプレミス [on-premise]
自社でデータセンターを保有して、システム構築から運営までを行う形態。<br>
システム基盤の構成要素であるサーバーやネットワーク機材を自らが購入＆調達し、
システム要件に応じてインフラを構築し、自社（又は関連子会社）で運用を行う。<br>
又、ハードウェアだけでなく、OSやミドルウェアも全て自社で購入し、ライセンス管理やバージョンアップも自前で行う。<br>

そのため、初期のシステム構築に多額の費用がかかる。<br>
更に、システム稼働後の運用にかかる費用も、”システムの使用量にかかわらず”一定額を負担しなくてはならないのが特徴である。<br>

<a id="ID_3-2-2"></a>

#### ☆　パブリッククラウド [public cloud]
![image](https://user-images.githubusercontent.com/25688193/41385096-7c622ebc-6fb4-11e8-9864-8a90ddd56d2e.png)<br>
インタネットを介して、”不特定多数に提供される”サービス。
自社でデータセンターを保有しなくて済むので、サーバーやネットワークなどのインフラに関する初期費用が不要となる。<br>
提供するサービスにより、**IaaS（イアース、アイアース） / PaaS（パース） / SaaS（サース）** などが存在する。<br>

![image](https://user-images.githubusercontent.com/25688193/41385123-a7c5b402-6fb4-11e8-872b-6fa54237e49a.png)<br>

![image](https://user-images.githubusercontent.com/25688193/41385487-f14e9c5e-6fb6-11e8-8bc6-e53726a39e03.png)<br>

![image](https://user-images.githubusercontent.com/25688193/41385504-0841d976-6fb7-11e8-8025-8592cc21d159.png)<br>

![image](https://user-images.githubusercontent.com/25688193/41385951-b3b6c3f0-6fb9-11e8-997b-b51535142cdd.png)<br>


<a id="ID_3-2-3"></a>

#### ☆ プライベートクラウド [private cloud]
![image](https://user-images.githubusercontent.com/25688193/41386506-989d9ed8-6fbc-11e8-9191-0154b10ece76.png)<br>

特定の企業グループにのみ提供されるクラウドサービス。<br>
利用者が限定されるため、セキュリティが担保しやすく、又、独自の機能やサービスを追加しやすいことが利点として挙げられる。


<a id="ID_3-2-4"></a>

#### ☆ クラウドとオンプレミスの選択

##### クラウドが適しているケース
一般的に、クラウドが向いているシステムには以下のようなケースが挙げられる。<br>

- トラフィックが変動しやすいシステム<br>
	システムには、従業員向けシステム（勤怠管理システム、経理システム等）もあれば、
	コンシューマ向け（予約システム、オンラインショッピング、オンラインゲームのバックエンド、動画配信等）も存在する。<br>
	前者の従業員向けシステムでは、利用者が限定されるためトラフィックの予想がしやすい。<br>
	一方、コンシューマ向けシステムでは、正確なトラフィックの予想が難しくなる。<br>
	このようなトラフィックの量に応じて、システム基盤のサーバーのスペークやネットワークの帯域を見積もる設計を **”サイジング”** と呼ぶ。
	サイジングが難しいシステムでは、トラフィックの量に応じてシステムを短期間に容易に増強できるクラウドが向いている。<br>

- 災害対策で日本以外にバックアップを構築したいシステム<br>
- 早くサービスインさせたいシステム<br>

##### オンプレミスが適しているケース

- 高い可用性が求められるシステム<br>
	クラウドでは、システムの可用性（ネットワークの瞬断が許されない等の要件）をクラウドベンダーが保証する。<br>
	従って、クラウドベンダーが保証する以上のシステムの可用性が必要となる場合には、クラウドを本番運用できない。<br>

- 機密性の高いデータを扱うシステム<br>
	データの（ハードウェア上の）保管場所は、クラウドクラウドベンダー側によって決められる。<br>
	従って、物理的な保管場所を明確にするシステムでは、データをパブリッククラウド上に保管することはできないことになる。<br>

- 特殊な要件があるシステム<br>
	特殊な要件、例えば、汎用的でないデバイスや特殊なプラットホーム上でしか動作しないシステム（医療システムなどの専用機器との接続が必要となるシステムなど）を構築、移行する必要がある場合、それらの環境にクラウド側が対応してなければ、クラウドを利用できない。<br>

<br>


<a id="ID_3-3"></a>

### ◎ ハードウェアとネットワークの基礎事項
システム基盤の最下位レイヤーを構成する要素は、ハードウェアとネットワークである。<br>
![image](https://user-images.githubusercontent.com/25688193/41751849-75806898-75fe-11e8-9acb-0aa35793cd1c.png)<br>

ここでは、Docker インフラを構成する際に基本となるハードウェア、ネットワークの基礎事項について見ていく。<br>

<a id="ID_3-3-1"></a>

#### ☆ サーバー機器
一般的なオンプレミスでのシステム基盤は、複数台のサーバー機器から構成される。<br>
クラウドの場合は、仮想マシンのインスタンス（オンプレミスでのサーバー機器に相当）の種類を要件に応じて選定する必要がある。<br>

- CPU<br>
	サーバーで利用される CPU の多くは、コア（CPUの演算回路。コアの数が多いほど同時に演算処理できる数が増加）を複数個もつマルチコアが利用される。<br>
	オンプレミスの場合でもクラウドの場合でも、高性能な CPU や GPU ほど多くの費用がかかる。<br>

- メモリ<br>
	サーバー用のメモリは、省電力でエラー処理が搭載されているものが多く選定させる。<br>
	オンプレミスの場合でもクラウドの場合でも、高性能なメモリほど多くの費用がかかる。<br>

- ストレージ<br>


<a id="ID_3-3-2"></a>

#### ☆ OSI 基本参照モデル
OSI 基本参照モデルは、ISO によって規定されたコンピューターの通信機能を階層構造に分割した概念モデルであり、通信プロトコルを７つの階層に分けて定義したものである。この階層化により、様々な技術同士の相互接続性を確保することが出来る。<br>
![image](https://user-images.githubusercontent.com/25688193/41754029-87f604c6-760b-11e8-91ad-42ca26fc795a.png)<br>

![image](https://user-images.githubusercontent.com/25688193/41753964-705e7ee2-760b-11e8-94cf-35b3d3beba0e.png)<br>

- 物理層（レイヤー１）<br>
	通信機器の物理的、電気的な特性に関する通信プロトコルを規定する。<br>
	具体的には、ビット列を電気信号に変換するための規定やケーブルやコネクタの形状などを規定する。<br>

- データリンク層（レイヤー２）<br>
	直接的に接続された同じネットワーク内（同一セグメントという）にあるノード間に関しての通信プロトコルを規定する。<br>
	具体的には、どのデバイスにデータ転送（パケット）するのかをネットワークデバイス固有の MAC アドレスで識別した上でデータ転送を行う。<br>
	レイヤー２におけるアドレッシング（デバイスを識別するために ID などの識別子を付随すること）は、
	デバイス固有の MAC アドレスを付随することであるが、より詳細には、宛先 MAC アドレスと送信元 MAC アドレスをフレーム情報として付随する。
	この際に、宛先 MAC アドレスは、実際に信号を送らないと取得できない。<br>

	尚、MAC アドレスは、実際のデバイスの位置情報を含まないため、インタネット上の場所を特定することはできない。<br>
	従って、後述のネットワーク層で付随される IP アドレスと一緒にしないと、どこにネットワークが存在するのかという情報を得ることはできず、結果として、異なるネットワーク内での通信を構築できない。<br>

- ネットワーク層（レイヤー３）<br>

- トランスポート層（レイヤー４）<br>

- セッション層（レイヤー５）<br>

- プレゼンテーション層（レイヤー６）<br>

- アプリケーション層（レイヤー７）<br>


OSI参照モデルでは、各層にそれぞれの通信に関する規定（通信プロトコル）を定めているが、
この通信プロトコルに基づいた通信データを作るために、第７層 → 第１層の順で各層の送り主や宛先などのヘッダー情報を入れてカプセル化する。<br>
逆に、送り先のコンピューターは、送られてきたデータを開封し、非カプセル化する。（下図参照）
![image](https://user-images.githubusercontent.com/25688193/41753120-6c16d064-7606-11e8-890a-702cb2c2b042.png)<br>
![image](https://user-images.githubusercontent.com/25688193/41753152-972370a0-7606-11e8-9fcd-edee34af4c39.png)<br>


<a id="ID_3-3-3"></a>

#### ☆ ネットワークアドレス

- MAC アドレス

- IP アドレス


<a id="ID_3-3-4"></a>

#### ☆ リピーター、ハブ
OSI参照モデルの第１層（物理層）に対応するネットワークデバイス。<br>
通信では、実際に回線（銅線、光ファイバー、無線LANなど）を通じてアナログ信号やデジタル信号を送るが、
この信号を送る際に、信号の減衰、ノイズ、衝突などの障害が発生することがある。<br>
これらは、ケーブルを使う際の電気抵抗が直接的な原因で発生するため、
この電気抵抗を減らし、多くの機材を接続することを可能にしたもののが、リピーターやハブというネットワークデバイスである。<br>

- リピーター<br>
	弱まったりノイズがのった信号に対して、増幅や整形をすることで元の同じ形に戻す役割を担う信号増幅器。<br>
	（スイッチやルーターとは異なり、制御は行わず、ただ単に信号を増幅するのみ。）<br>

- ハブ<br>
	リピーターと同様に信号の整形目的での信号の増幅を行い、かつ多くの機材を接続することが出来る装置。<br>


<a id="ID_3-3-5"></a>

#### ☆ ブリッジ、レイヤー２スイッチ
OSI 参照モデルの第２層（ネットワーク層）に対応するネットワークデバイス。<br>
ネットワーク層では、同じネットワーク内のデバイス間通信を、MACアドレスを付随することで実現するが、
イーサネットでは、この際に通信のコリジョンが発生してしまう可能性がある。<br>
この通信のコリジョンを解決するのがブリッジや（レイヤー２）スイッチである。<br>

- ブリッジ<br>
	衝突ドメインのようなネットワークの区切りであるセグメント（言い換えれば、直接的に接続された同じネットワーク）において、
	**２つのセグメントを繋げるのが、ブリッジの基本的な役割である。**<br>
	又、**MAC アドレスフィルタリング**の役割も持つ。<br>
	**このフィルタリング機能により、衝突ドメインを分割し、結果として、通信トラフィックを低下させることが出来る。**<br>

- （レイヤー２）スイッチ<br>
	基本的には、ブリッジと同様の機能をもつが、異なる点は、マルチポートでスイッチングするという点である。<br>
	詳細には、ブリッジが異なる？ネットワークにフレーム（MACアドレスを付随した通信データ）を送信するかしないかだけを判断するネットワークデバイスであったのに対し、<br>
	**スイッチは、自身が所持しているアドレステーブルを参考にして、各デバイスの送信元と宛先が１対１で接続されている状態にすることが出来る。（マルチポート）**


<a id="ID_3-3-6"></a>

#### ☆ ルーター、レイヤー３スイッチ


<a id="ID_3-3-7"></a>

#### ☆ ファイアウォール


<br>

<a id="ID_3-x"></a>

### ◎ システム基盤の構築、運用の流れ
従来のウォータフォール開発の場合、上流工程から下流工程に順に進めていくことになる。<br>
以下の図は、（インフラ開発における）ウォータフォール開発での手順である。<br>
![image](https://user-images.githubusercontent.com/25688193/41749195-1967c0e6-75f0-11e8-8b3c-3c68949c29c7.png)<br>

一方、アジャイル開発の場合は、迅速かつ適応的に開発を進めていくために、各フェーズでの処理単位を繰り返しながら開発を進めていくことになる。<br>
以下の図は、（インフラ開発における）アジャイル開発での手順である。<br>
![image](https://user-images.githubusercontent.com/25688193/41749981-737b31e0-75f4-11e8-880d-b3497dc83c93.png)<br>

どちらの開発手法の場合でも、（インフラ開発における）ウォータフォール開発やアジャイル開発において、アプリケーション開発とインフラ開発の違いは、**運用フェーズ**の存在となる。<br>
アプリケーション開発においては、プロダクション環境へのシステムリリース後は、バグの修正や追加機能の開発がメインとなり開発要員も減る。
一方でインフラ開発の場合は、リソース監視やセキュリティ対策のためのバージョンアップ、システム障害時対応などの定常業務が残る。<br>
このシステム運用にかかる工程を出来る限り削減し、システムを安定駆動させるために重要なのが**運用設計**となる。具体的には、工程を減らすためにシステム運用で自動化可能な工程を出来る限り自動化するように運用設計することが重要となる。<br>
**Docker は、このシステム構築やシステム運用において、これまで人手で行なっていた作業の多くを自動化し、テスト済みの安全なアプリケーションを継続的に提供することの出来るプラットホームである。**

---

## ■ 
